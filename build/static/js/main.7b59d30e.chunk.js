(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(6),i=n.n(c),s=(n(14),n(9)),r=n(2),l=n.p+"static/media/header__logo.03b78ada.svg",u=n(0);var d=function(){return Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("img",{className:"logo",src:l,alt:"Mesto"})})},h=Object(a.createContext)();var j=function(e){var t=e.card,n=e.onCardClick,o=e.onCardLike,c=e.onCardDelete,i=Object(a.useContext)(h),s=t.owner._id===i._id,r=t.likes.some((function(e){return e._id===i._id})),l="button button_type_like ".concat(r?"button_type_like_active":""),d="button ".concat(s?"button_type_delete":"button_type_delete_hidden");return Object(u.jsxs)("li",{className:"card",children:[Object(u.jsx)("img",{className:"card__image",src:t.link,alt:t.name,onClick:function(){n(t)}}),Object(u.jsxs)("div",{className:"card__content",children:[Object(u.jsx)("h2",{className:"card__heading",children:t.name}),Object(u.jsxs)("div",{className:"card__like",children:[Object(u.jsx)("button",{type:"button",className:l,"aria-label":"\u041b\u0430\u0439\u043a",onClick:function(){o(t)}}),Object(u.jsx)("p",{className:"card__likes-counter",children:t.likes.length})]}),Object(u.jsx)("button",{type:"button",className:d,"aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",onClick:function(){c(t)}})]})]})};var m=function(e){var t=e.cards,n=e.onCardLike,o=e.onCardDelete,c=e.onEditProfile,i=e.onEditAvatar,s=e.onAddPlace,r=e.onCardClick,l=Object(a.useContext)(h);return Object(u.jsxs)("main",{className:"content",children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsxs)("div",{className:"profile__avatar",children:[Object(u.jsx)("img",{className:"profile__avatar-image",src:null===l||void 0===l?void 0:l.avatar,alt:null===l||void 0===l?void 0:l.name}),Object(u.jsx)("button",{type:"button",className:"button button_type_edit-avatar","aria-label":"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",onClick:i})]}),Object(u.jsxs)("div",{className:"profile__info",children:[Object(u.jsx)("h1",{className:"profile__name",children:null===l||void 0===l?void 0:l.name}),Object(u.jsx)("button",{type:"button",className:"button button_type_edit","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:c}),Object(u.jsx)("p",{className:"profile__job",children:null===l||void 0===l?void 0:l.about})]}),Object(u.jsx)("button",{type:"button",className:"button button_type_add","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e",onClick:s})]}),Object(u.jsx)("section",{className:"cards",children:Object(u.jsx)("ul",{className:"cards__list",children:t.map((function(e){return Object(u.jsx)(j,{card:e,onCardClick:r,onCardLike:n,onCardDelete:o},e._id)}))})})]})};var b=function(){var e=(new Date).getFullYear();return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",e," Mesto Russia"]})})};var _=function(e){var t=e.name,n=e.title,a=e.btnText,o=e.children,c=e.isOpen,i=e.onClose,s=e.onSubmit;return Object(u.jsx)("article",{className:"popup popup_type_".concat(t," ").concat(c?"popup_opened":""),children:Object(u.jsx)("div",{className:"popup__container",children:Object(u.jsxs)("form",{className:"form",method:"POST",name:t,noValidate:!0,onSubmit:s,children:[Object(u.jsx)("h3",{className:"form__heading",children:n}),o,Object(u.jsx)("button",{className:"form__submit-button",type:"submit",children:a}),Object(u.jsx)("button",{className:"button button_type_close",type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:i})]})})})};var f=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateUser,c=e.isLoading,i=Object(a.useState)(""),s=Object(r.a)(i,2),l=s[0],d=s[1],j=Object(a.useState)(""),m=Object(r.a)(j,2),b=m[0],f=m[1],p=Object(a.useContext)(h);return Object(a.useEffect)((function(){d(null===p||void 0===p?void 0:p.name),f(null===p||void 0===p?void 0:p.about)}),[p,t]),Object(u.jsxs)(_,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",btnText:c?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o({name:l,about:b})},children:[Object(u.jsxs)("section",{className:"form__section",children:[Object(u.jsx)("input",{className:"form__item form__item_element_name",type:"text",name:"name",id:"name",placeholder:"\u0418\u043c\u044f",value:l||"",onChange:function(e){d(e.target.value)},minLength:"2",maxLength:"40",required:!0}),Object(u.jsx)("span",{className:"form__item-error",id:"name-error"})]}),Object(u.jsxs)("section",{className:"form__section",children:[Object(u.jsx)("input",{className:"form__item form__item_element_job",type:"text",name:"about",id:"about",placeholder:"\u041e \u0441\u0435\u0431\u0435",value:b||"",onChange:function(e){f(e.target.value)},minLength:"2",maxLength:"200",required:!0}),Object(u.jsx)("span",{className:"form__item-error",id:"about-error"})]})]})};var p=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateAvatar,c=e.isLoading,i=Object(a.useRef)();return Object(u.jsx)(_,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",btnText:c?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o({avatar:i.current.value})},children:Object(u.jsxs)("section",{className:"form__section",children:[Object(u.jsx)("input",{className:"form__item form__item_element_image-link",type:"url",name:"avatar",id:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,ref:i}),Object(u.jsx)("span",{className:"form__item-error",id:"avatar-error"})]})})};var O=function(e){var t=e.isOpen,n=e.onClose,o=e.onAddPlace,c=e.isLoading,i=Object(a.useState)(""),s=Object(r.a)(i,2),l=s[0],d=s[1],h=Object(a.useState)(""),j=Object(r.a)(h,2),m=j[0],b=j[1];return Object(u.jsxs)(_,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",btnText:c?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o({name:l,link:m})},children:[Object(u.jsxs)("section",{className:"form__section",children:[Object(u.jsx)("input",{className:"form__item form__item_element_name",type:"text",name:"name",id:"image-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:l||"",onChange:function(e){d(e.target.value)},minLength:"2",maxLength:"30",required:!0}),Object(u.jsx)("span",{className:"form__item-error",id:"image-name-error"})]}),Object(u.jsxs)("section",{className:"form__section",children:[Object(u.jsx)("input",{className:"form__item form__item_element_image-link",type:"url",name:"link",id:"image-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",value:m||"",onChange:function(e){b(e.target.value)},required:!0}),Object(u.jsx)("span",{className:"form__item-error",id:"image-link-error"})]})]})};var v=function(e){var t=e.isOpen,n=e.onClose,a=e.isLoading,o=e.onCardDelete,c=e.card;return Object(u.jsx)(_,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete-card",btnText:a?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430.",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o(c)}})};var x=function(e){var t=e.card,n=e.onClose;return Object(u.jsx)("article",{className:"popup ".concat(t?"popup_opened":""),children:Object(u.jsx)("div",{className:"popup__container",children:Object(u.jsxs)("figure",{className:"figure",children:[Object(u.jsxs)("figcaption",{className:"figure__figcaption",children:[Object(u.jsx)("img",{className:"figure__image",src:null===t||void 0===t?void 0:t.link,alt:null===t||void 0===t?void 0:t.name}),Object(u.jsx)("p",{className:"figure__caption",children:null===t||void 0===t?void 0:t.name})]}),Object(u.jsx)("button",{className:"button button_type_close",type:"reset","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:n})]})})})},g=n(7),C=n(8),k=new(function(){function e(t){var n=t.adress,a=t.token,o=t.cohortId;Object(g.a)(this,e),this._adress=n,this._token=a,this._cohortId=o}return Object(C.a)(e,[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/users/me"),{headers:{authorization:this._token}}).then((function(t){return e._handleResponse(t)}))}},{key:"editUserAvatar",value:function(e){var t=this;return fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.avatar})}).then((function(e){return t._handleResponse(e)}))}},{key:"editUserInfo",value:function(e){var t=this;return fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return t._handleResponse(e)}))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/cards"),{headers:{authorization:this._token}}).then((function(t){return e._handleResponse(t)}))}},{key:"addCard",value:function(e){var t=this;return fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._handleResponse(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){var n=this;return t?fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._token}}).then((function(e){return n._handleResponse(e)})):fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return n._handleResponse(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._adress,"/v1/").concat(this._cohortId,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._handleResponse(e)}))}}]),e}())({adress:"https://mesto.nomoreparties.co",token:"12e16369-63c3-45db-b812-aa3f60268f30",cohortId:"cohort-22"});var N=function(){var e=Object(a.useState)(),t=Object(r.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)([]),i=Object(r.a)(c,2),l=i[0],j=i[1],_=Object(a.useState)(!1),g=Object(r.a)(_,2),C=g[0],N=g[1],y=Object(a.useState)(!1),S=Object(r.a)(y,2),L=S[0],I=S[1],T=Object(a.useState)(!1),P=Object(r.a)(T,2),D=P[0],E=P[1],U=Object(a.useState)(!1),A=Object(r.a)(U,2),R=A[0],z=A[1],q=Object(a.useState)(null),w=Object(r.a)(q,2),F=w[0],J=w[1],M=Object(a.useState)(null),B=Object(r.a)(M,2),H=B[0],V=B[1],Y=Object(a.useState)(!1),G=Object(r.a)(Y,2),K=G[0],Q=G[1];function W(){E(!1),N(!1),I(!1),z(!1),J(null),V(null)}return Object(a.useEffect)((function(){k.getUserInfo().then((function(e){o(e)})).catch((function(e){return console.log(e)})),k.getInitialCards().then((function(e){j(e)})).catch((function(e){return console.log(e)}))}),[]),Object(u.jsx)("div",{className:"page__container",children:Object(u.jsxs)(h.Provider,{value:n,children:[Object(u.jsx)(d,{}),Object(u.jsx)(m,{cards:l,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===n._id}));k.changeLikeCardStatus(e._id,!t).then((function(t){j((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){z(!0),J(e)},onEditProfile:function(){N(!0)},onEditAvatar:function(){E(!0)},onAddPlace:function(){I(!0)},onCardClick:function(e){V(e)}}),Object(u.jsx)(b,{}),Object(u.jsx)(f,{isOpen:C,onClose:W,onUpdateUser:function(e){Q(!0),k.editUserInfo(e).then((function(e){o(e),W()})).catch((function(e){return console.log(e)})).finally((function(){Q(!1)}))},isLoading:K}),Object(u.jsx)(p,{isOpen:D,onClose:W,onUpdateAvatar:function(e){Q(!0),k.editUserAvatar(e).then((function(e){o(e),W()})).catch((function(e){return console.log(e)})).finally((function(){Q(!1)}))},isLoading:K}),Object(u.jsx)(O,{isOpen:L,onClose:W,onAddPlace:function(e){Q(!0),k.addCard(e).then((function(e){j([e].concat(Object(s.a)(l))),W()})).catch((function(e){return console.log(e)})).finally((function(){Q(!1)}))},isLoading:K}),Object(u.jsx)(v,{isOpen:R,onClose:W,onCardDelete:function(e){Q(!0),k.deleteCard(e._id).then((function(){j((function(t){return t.filter((function(t){return t._id!==e._id}))})),W()})).catch((function(e){return console.log(e)})).finally((function(){Q(!1)}))},isLoading:K,card:F}),Object(u.jsx)(x,{card:H,onClose:W})]})})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),c(e),i(e)}))};i.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(N,{})}),document.getElementById("root")),y()}},[[16,1,2]]]);
//# sourceMappingURL=main.7b59d30e.chunk.js.map